<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Crypt Project</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Welcome to Crypt</h1>
            <p class="tagline">Secure messaging for fun & mischief (maybe in class)</p>
        </header>

        <main>
            <section>
                <h2>Download</h2>
                <p>
                    <a class="download-btn" href="{link}">Download Crypt {version}</a>
                </p>
                <p>This download link auto-updates with every new release.</p>
            </section>

            <section>
                <h2>About</h2>
                <p>Crypt is an encryption system for sending secret messages. Inspired by questionable class antics, this project is totally educational... <em>probably.</em></p>
            </section>

            <section>
                <h2>Get Involved</h2>
                <p>Want to contribute or join the Crypt team?</p>
                <ul>
                    <li><a id="user-apply-link" href="#">Apply for a user account</a></li>
                    <li><a href="mailto:updates.cryptexe@outlook.com?subject=Recruitment">Join the Crypt team</a></li>
                </ul>
            </section>
        </main>

        <footer>
            <p>&copy; 2025 Crypt Project. All rights reserved.</p>
        </footer>
    </div>

    <script>
    const BIN_ID = "67b6c25cacd3cb34a8e9372c"; 
    const API_KEY = "$2a$10$coWigkYNJbj.z.EUyfjUgurk/Xkg/olZFEXFWplgUtfIhtY9m/rOC"; // (OK if public info only)

    fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        headers: {
            "X-Access-Key": API_KEY
        }
    })
    .then(res => res.json())
    .then(data => {
        const content = data.record;
        const version = content.version || "latest";
        const link = content.link || "#";
        const id = Math.floor(Math.random() * 900000 + 100000);
        const message = encodeURIComponent("Hi! Iâ€™d like to join Crypt. Here's my username and password:");

        // Replace in download button
        document.querySelectorAll(".download-btn").forEach(el => {
            el.href = link;
            el.textContent = `Download Crypt ${version}`;
        });

        // Update user application email
        const userLink = document.getElementById("user-apply-link");
        if (userLink) {
            userLink.href = `mailto:updates.cryptexe@outlook.com?subject=User Application: ${id}&body=${message}`;
        }
    })
    .catch(err => {
        console.error("Failed to load JSONBin data:", err);
    });
    </script>
</body>
</html>
